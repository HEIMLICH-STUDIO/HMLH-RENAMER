<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RENAMER by HEIMLICH®</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app-container">
    <!-- Left sidebar with rename settings -->
    <div class="sidebar">
      <!-- 고정 상단 영역 -->
      <div class="sidebar-fixed-header">
        <div class="logo">
          <img src="assets/HEIMLICH_TYPOLOGO.svg" alt="FILE RENAMER by HEIMLICH" class="logo-image">
        </div>
        
        <div class="method-tabs">
          <div class="tab active" data-method="pattern">Pattern</div>
          <div class="tab" data-method="replace">Replace</div>
          <div class="tab" data-method="regex">Regex</div>
          <div class="tab" data-method="word">Word</div>
          <div class="tab" data-method="numbering">Numbering</div>
          <div class="tab" data-method="expression">Expression</div>
        </div>
      </div>
      
      <!-- 스크롤 가능한 중간 영역 -->
      <div class="rename-settings">
        <!-- Pattern Method -->
        <div class="method-content active" id="pattern-panel">
          <div class="input-group">
            <input type="text" id="patternInput" placeholder="Format: {name}_{num}.{ext}" value="{name}">
          </div>
          <div class="hint">
            <span>Variables: {name}, {ext}, {num}, {date}</span>
          </div>
          
          <!-- 날짜 포맷 설정 UI (기본적으로 숨겨져 있음) -->
          <div class="date-format-container" id="dateFormatContainer">
            <div class="format-header">
              <span class="format-title">Date Format</span>
              <div class="format-toggle" id="toggleDateOptions">Options ▼</div>
            </div>
            
            <div class="date-format-options" id="dateFormatOptions">
              <div class="format-option">
                <select id="dateFormatPreset">
                  <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                  <option value="YYYYMMDD">YYYYMMDD</option>
                  <option value="DD-MM-YYYY">DD-MM-YYYY</option>
                  <option value="MM-DD-YYYY">MM-DD-YYYY</option>
                  <option value="YYYY_MM_DD">YYYY_MM_DD</option>
                  <option value="YY-MM-DD">YY-MM-DD</option>
                  <option value="custom">Custom format...</option>
                </select>
              </div>
              
              <div class="custom-format" id="customDateFormat">
                <input type="text" id="dateFormatCustom" placeholder="e.g. YYYY/MM/DD HH:mm">
                <div class="format-help">
                  <div class="help-item"><span>YYYY</span>: Year (4 digits)</div>
                  <div class="help-item"><span>YY</span>: Year (2 digits)</div>
                  <div class="help-item"><span>MM</span>: Month (01-12)</div>
                  <div class="help-item"><span>DD</span>: Day (01-31)</div>
                  <div class="help-item"><span>HH</span>: Hours (00-23)</div>
                  <div class="help-item"><span>mm</span>: Minutes (00-59)</div>
                  <div class="help-item"><span>ss</span>: Seconds (00-59)</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Find & Replace Method -->
        <div class="method-content" id="replace-panel">
          <div class="input-group">
            <input type="text" id="findText" placeholder="Find text">
          </div>
          
          <button class="swap-inputs-btn" id="swapReplaceBtn" title="Swap find and replace">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="12" y1="5" x2="12" y2="19"></line>
              <polyline points="19 12 12 19 5 12"></polyline>
            </svg>
          </button>
          
          <div class="input-group">
            <input type="text" id="replaceText" placeholder="Replace with">
          </div>
          <div class="checkbox-group">
            <label class="checkbox">
              <input type="checkbox" id="caseSensitive">
              <span>Case sensitive</span>
            </label>
          </div>
        </div>
        
        <!-- Regex Method -->
        <div class="method-content" id="regex-panel">
          <div class="input-group">
            <input type="text" id="regexPattern" placeholder="Regular expression">
          </div>
          <div class="input-group">
            <input type="text" id="regexReplacement" placeholder="Replacement ($1, $2...)">
          </div>
        </div>
        
        <!-- Word Selection Method -->
        <div class="method-content" id="word-panel">
          <div class="hint">
            <span>Select words from filenames to modify</span>
          </div>
          <div class="checkbox-group">
            <label class="checkbox">
              <input type="checkbox" id="applyToAllFiles">
              <span>Apply to all files with same patterns</span>
            </label>
          </div>
          <div class="input-group" id="wordRulesContainer">
            <!-- Word rules will be dynamically added here -->
          </div>
          <button id="addWordRuleBtn" class="btn-outline">+ Add Rule</button>
        </div>
        
        <!-- Numbering Method - NEW -->
        <div class="method-content" id="numbering-panel">
          <div class="input-group">
            <label class="input-label">Format</label>
            <input type="text" id="numberingPattern" placeholder="Format: {name}_{num}.{ext}" value="{name}_{num}">
          </div>
          
          <div class="input-group number-settings">
            <div class="number-setting">
              <label class="input-label">Start Number</label>
              <input type="number" id="startNumber" min="0" value="1">
            </div>
            <div class="number-setting">
              <label class="input-label">Padding</label>
              <input type="number" id="numberPadding" min="0" max="10" value="2">
            </div>
            <div class="number-setting">
              <label class="input-label">Step</label>
              <input type="number" id="numberStep" min="1" value="1">
            </div>
          </div>
          
          <div class="input-group">
            <label class="input-label">Sort By</label>
            <select id="sortingMethod">
              <option value="name">Name</option>
              <option value="date">Date Modified</option>
              <option value="size">File Size</option>
              <option value="random">Random</option>
            </select>
          </div>
          
          <div class="checkbox-group">
            <label class="checkbox">
              <input type="checkbox" id="reverseOrder">
              <span>Reverse Order</span>
            </label>
          </div>
        </div>
        
        <!-- Expression Method - NEW -->
        <div class="method-content" id="expression-panel">
          <div class="hint">
            <span>Use expressions like Houdini for advanced renaming</span>
          </div>
          
          <div class="input-group">
            <textarea id="expressionInput" rows="5" placeholder="Example: 
name + '_' + padnum(index + 1, 3) + (fileext ? '.' + fileext : '')"></textarea>
          </div>
          
          <div class="expression-actions">
            <button id="expressionExamplesBtn" class="btn-outline btn-small">Examples</button>
            <button id="toggleExpressionHelpBtn" class="btn-outline btn-small">Help ▼</button>
          </div>
          
          <div class="hint expression-help" id="expressionHelp">
            <h4>Variables:</h4>
            <div class="var-list">
              <div class="var-item"><span class="var">name</span> - File name without extension</div>
              <div class="var-item"><span class="var">fileext</span> - File extension</div>
              <div class="var-item"><span class="var">index</span> - File index (0-based)</div>
              <div class="var-item"><span class="var">width, height</span> - Image width/height in pixels</div>
              <div class="var-item"><span class="var">duration</span> - Video duration in seconds</div>
              <div class="var-item"><span class="var">isImage</span> - True if file is image</div>
              <div class="var-item"><span class="var">isVideo</span> - True if file is video</div>
              <div class="var-item"><span class="var">date</span> - File creation date</div>
              <div class="var-item"><span class="note">Note: Special formats (EXR, DPX, TIF) and videos are supported</span></div>
            </div>
            
            <h4>Functions:</h4>
            <div class="var-list">
              <div class="var-item"><span class="var">padnum(num, len)</span> - Zero-padded number</div>
              <div class="var-item"><span class="var">upper(s)</span> - Uppercase string</div>
              <div class="var-item"><span class="var">lower(s)</span> - Lowercase string</div>
              <div class="var-item"><span class="var">cond(cond, t, f)</span> - Conditional (if-then-else)</div>
              <div class="var-item"><span class="var">substr(s, start, len)</span> - Substring</div>
              <div class="var-item"><span class="var">formatTime(seconds)</span> - Format to HH:MM:SS</div>
            </div>
            
            <h4>Examples:</h4>
            <div class="var-list">
              <div class="var-item"><code>name + "_" + padnum(index + 1, 3)</code></div>
              <div class="var-item"><code>upper(name) + "_" + date</code></div>
              <div class="var-item"><code>cond(isVideo, "VID_" + formatTime(duration), name)</code></div>
              <div class="var-item"><code>cond(width > height, "landscape_", "portrait_") + name</code></div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 고정 하단 영역 -->
      <div class="sidebar-fixed-footer">
        <!-- Rules Management Section -->
        <div class="rules-management">
          <div class="rules-header">
            <h3>Rule Management</h3>
            <div class="rule-buttons">
              <button id="saveRuleBtn" class="btn-outline btn-small">Save Rule</button>
              <button id="viewRulesBtn" class="btn-outline btn-small">View Rules</button>
            </div>
          </div>
        </div>
        
        <button id="applyBtn" class="btn-primary" disabled>Rename Files</button>
        
        <div class="sidebar-footer">
          <button id="clearBtn" class="btn-text">Clear All</button>
        </div>
        
        <div class="sidebar-footer-version">
          <span>© 2025 <a href="https://heimlich.studio" class="footer-link"> HEIMLICH®</a> <a href="https://github.com/HEIMLICH-STUDIO/HMLH-RENAMER/releases" class="footer-link">Version 0.0.1</a></span>
        </div>
      </div>
    </div>
    
    <!-- Right content area -->
    <div class="main-content" id="dropArea">
      <div class="content-header">
        <h2>Files</h2>
        <div class="history-buttons">
          <button id="undoBtn" class="history-btn disabled" title="Undo" disabled>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 14L4 9L9 4"></path>
              <path d="M4 9H16C18.7614 9 21 11.2386 21 14C21 16.7614 18.7614 19 16 19H11"></path>
            </svg>
          </button>
          <button id="redoBtn" class="history-btn disabled" title="Redo" disabled>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M15 14L20 9L15 4"></path>
              <path d="M20 9H8C5.23858 9 3 11.2386 3 14C3 16.7614 5.23858 19 8 19H13"></path>
            </svg>
          </button>
        </div>
        <div class="file-count">
          <span id="fileCount">0</span> files
        </div>
      </div>
      
      <div class="content-body">
        <!-- Empty state / Drop indicator -->
        <div class="empty-drop-area" id="emptyDropArea">
          <div class="drop-icon">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 4V16M12 16L8 12M12 16L16 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M20 20H4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <p>Drop files here to rename them</p>
          <button id="fileSelectBtn" class="btn-outline">Select Files</button>
        </div>
        
        <!-- Files with preview integrated -->
        <div class="files-preview" id="filesPreview">
          <!-- Preview takes full space now -->
          <div class="preview-container">
            <div class="preview-header">
              <h3>Preview</h3>
            </div>
            <div id="previewArea" class="preview-area"></div>
          </div>
        </div>
      </div>
      
      <!-- Results overlay -->
      <div id="resultArea" class="result-area hidden">
        <div class="result-container">
          <div class="result-header">
            <h3>Results</h3>
            <button id="closeResultsBtn" class="btn-close">&times;</button>
          </div>
          <div id="resultList" class="result-list"></div>
          <div class="result-actions">
            <button id="doneBtn" class="btn-primary">Done</button>
          </div>
        </div>
      </div>
      
      <!-- Rules Modal -->
      <div id="rulesModal" class="modal-overlay hidden">
        <div class="modal-container">
          <div class="modal-header">
            <h3>Saved Rules</h3>
            <button id="closeRulesModalBtn" class="btn-close">&times;</button>
          </div>
          <div id="modalRulesList" class="modal-body">
            <!-- Rules will be listed here -->
          </div>
        </div>
      </div>
      
      <!-- Input Modal for Rule Name -->
      <div id="inputModal" class="modal-overlay hidden">
        <div class="modal-container modal-small">
          <div class="modal-header">
            <h3 id="inputModalTitle">Enter Rule Name</h3>
            <button id="closeInputModalBtn" class="btn-close">&times;</button>
          </div>
          <div class="modal-body">
            <div class="input-group">
              <input type="text" id="inputModalField" placeholder="Rule name">
            </div>
            <div class="modal-actions">
              <button id="inputModalCancelBtn" class="btn-secondary">Cancel</button>
              <button id="inputModalConfirmBtn" class="btn-primary">Save</button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Expression Examples Modal -->
      <div id="expressionExamplesModal" class="modal-overlay hidden">
        <div class="modal-container">
          <div class="modal-header">
            <h3>Expression Examples</h3>
            <button id="closeExpressionExamplesBtn" class="btn-close">&times;</button>
          </div>
          <div class="modal-body">
            <div class="examples-container">
              <div class="example-category">
                <h4>Basic Usage</h4>
                <div class="example-items">
                  <div class="example-item" data-expression="name + '_' + padnum(index + 1, 3) + '.' + fileext">
                    <div class="example-name">Sequential Numbering</div>
                    <code>name + '_' + padnum(index + 1, 3) + '.' + fileext</code>
                    <div class="example-desc">Adds a 3-digit sequential number to filenames</div>
                  </div>
                  <div class="example-item" data-expression="upper(name) + '.' + fileext">
                    <div class="example-name">Uppercase</div>
                    <code>upper(name) + '.' + fileext</code>
                    <div class="example-desc">Converts filename to uppercase</div>
                  </div>
                  <div class="example-item" data-expression="lower(name) + '.' + fileext">
                    <div class="example-name">Lowercase</div>
                    <code>lower(name) + '.' + fileext</code>
                    <div class="example-desc">Converts filename to lowercase</div>
                  </div>
                </div>
              </div>
              
              <div class="example-category">
                <h4>Image Operations</h4>
                <div class="example-items">
                  <div class="example-item" data-expression="cond(isImage, name + '_' + width + 'x' + height, name) + '.' + fileext">
                    <div class="example-name">Add Image Dimensions</div>
                    <code>cond(isImage, name + '_' + width + 'x' + height, name) + '.' + fileext</code>
                    <div class="example-desc">Adds width×height to image filenames</div>
                  </div>
                  <div class="example-item" data-expression="cond(isImage, cond(width > height, 'landscape_', 'portrait_'), '') + name + '.' + fileext">
                    <div class="example-name">Orientation Prefix</div>
                    <code>cond(isImage, cond(width > height, 'landscape_', 'portrait_'), '') + name + '.' + fileext</code>
                    <div class="example-desc">Adds landscape/portrait prefix based on dimensions</div>
                  </div>
                  <div class="example-item" data-expression="cond(isImage && width >= 1920, 'HD_', '') + name + '.' + fileext">
                    <div class="example-name">HD Image Marker</div>
                    <code>cond(isImage && width >= 1920, 'HD_', '') + name + '.' + fileext</code>
                    <div class="example-desc">Adds HD_ prefix to images at least 1920px wide</div>
                  </div>
                </div>
              </div>
              
              <div class="example-category">
                <h4>Advanced Patterns</h4>
                <div class="example-items">
                  <div class="example-item" data-expression="'IMG_' + date + '_' + padnum(index + 1, 4) + '.' + fileext">
                    <div class="example-name">Date-Based Naming</div>
                    <code>'IMG_' + date + '_' + padnum(index + 1, 4) + '.' + fileext</code>
                    <div class="example-desc">Creates filename with date and sequence number</div>
                  </div>
                  <div class="example-item" data-expression="cond(index % 2 === 0, 'even_', 'odd_') + name + '.' + fileext">
                    <div class="example-name">Even/Odd Prefix</div>
                    <code>cond(index % 2 === 0, 'even_', 'odd_') + name + '.' + fileext</code>
                    <div class="example-desc">Adds even_ or odd_ prefix based on file index</div>
                  </div>
                  <div class="example-item" data-expression="name + '_' + substr(date, 0, 4) + '.' + fileext">
                    <div class="example-name">Year Suffix</div>
                    <code>name + '_' + substr(date, 0, 4) + '.' + fileext</code>
                    <div class="example-desc">Adds the year from date as a suffix</div>
                  </div>
                </div>
              </div>
            </div>
            <div id="copyStatus" class="copy-status hidden">Copied to clipboard!</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <script src="renderer.js"></script>
</body>
</html> 